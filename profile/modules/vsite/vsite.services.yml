services:
  vsite.app.manager:
    class: Drupal\vsite\Plugin\AppManager
    parent: default_plugin_manager
    arguments: ['@os_widgets_context.context']
  hierarchical.storage:
    class: Drupal\vsite\Config\HierarchicalStorage
    decorates: config.storage
    decoration_priority: 4
    arguments: ['@hierarchical.storage.inner']
  vsite.storage:
    class: Drupal\vsite\Config\VsiteStorageDefinition
    arguments: ['@hierarchical.storage']
    tags:
      - { name: event_subscriber }
  vsite.outboundpathprocessor:
    class: Drupal\vsite\PathProcessor\VsiteOutboundPathProcessor
    arguments:
      - '@vsite.context_manager'
    tags:
      - { name: path_processor_outbound, priority: 299 }
  vsite.context_manager:
    class: Drupal\vsite\Plugin\VsiteContextManager
    arguments:
      - '@event_dispatcher'
      - '@database'
  vsite.path_activator:
    class: Drupal\vsite\Plugin\VsitePathActivator
    arguments:
      - '@vsite.context_manager'
      - '@entity_type.manager'
    tags:
      - { name: event_subscriber }
  vsite.alias_storage:
    class: Drupal\vsite\Path\VsiteAliasStorage
    decorates: path.alias_storage
    decoration_priority: 4
    arguments:
      - '@vsite.alias_storage.inner'
      - '@purl.modifier_index'
      - '@entity_type.manager'
      - '@vsite.context_manager'
  vsite.typed_data_manager:
    class: Drupal\vsite\Plugin\VsiteTypedDataManager
    decorates: typed_data_manager
    decoration_priority: 4
    arguments: ['@container.namespaces', '@cache.discovery', '@module_handler', '@class_resolver', '@config.factory']
    tags:
      - { name: event_subscriber }
  access_check.group.permission:
    class: 'Drupal\vsite\Access\VsiteGroupPermissionAccessCheck'
    arguments:
      - '@current_route_match'
    tags:
    - { name: 'access_check', applies_to: '_group_permission' }
  cache_context.vsite:
    class: Drupal\vsite\Cache\VsiteCacheContext
    arguments: ['@vsite.context_manager']
    tags:
      - { name: cache.context }

  vsite.form_delete_destination:
    class: Drupal\vsite\FormDeleteDestination
    arguments: ['@vsite.context_manager']

  vsite.validate_helper:
    class: Drupal\vsite\Helper\VsiteFieldValidateHelper
    arguments: ['@vsite.context_manager', '@entity_type.manager']

  vsite.role_helper:
    class: \Drupal\vsite\Helper\VsiteRoleHelper
